import{_ as a,l as e,A as s,L as r,F as l,aq as o,ar as n,z as i}from"./index-Sm2rxOHe.js";import{B as t}from"./index-7etSgMpZ.js";import{r as c,o as u,L as v,O as d,f as p,P as m,z as f,R as g,m as _,$ as k,Q as x,l as y,S as w}from"./vue-vendor-C3e-Kb3Z.js";import"./use-route-BAW5XLj3.js";const b={class:"page-wrapper"},h={class:"page-wrapper-body"},z={class:"page-wrapper-header"},j={class:"title"},C={class:"content-section"},L={key:0,class:"loading-box"},q={class:"loading-text"},I={key:1,class:"error-box"},R={class:"error-text"},S=["src"],A=a({__name:"CustomerService",setup(a){const A=x(),B=k(),{t:E}=e.global,F=c(!0),O=c(""),P=c(""),Q=()=>{O.value="客服页面加载失败，请稍后重试",P.value="",F.value=!1},U=()=>{},$=async()=>{F.value=!0,O.value="";const a=B.query.kf_url;if(a)try{const e=decodeURIComponent(a),s=o(e);if(s)return P.value=s,void(F.value=!1)}catch(e){}try{const a=await n({}),e=a?.data||{},s=e.agent_url||e.broker_url||e.salesman_url||e.agent_kf_url,r=e.proxy_url||e.agency_url||e.proxy_kf_url;let l=s||r||e.url||e.kf_url||e.customer_service||e.top_kf||"/index/user/kfindex";const t=o(l);if(t)P.value=t;else{const a=window.location.origin+"/index/user/kfindex",e=o(a);e?P.value=e:(O.value="客服链接无效，请联系管理员",i(O.value))}F.value=!1}catch(e){F.value=!1,O.value=e.msg||"加载客服链接失败",i(O.value)}};return u(()=>{$()}),(a,e)=>{const o=s,n=r,i=t;return y(),v("div",b,[e[3]||(e[3]=d("div",{class:"page-bg"},null,-1)),e[4]||(e[4]=d("div",{class:"page-mask"},null,-1)),d("div",h,[d("section",z,[p(o,{name:"arrow-left",class:"icon-box",size:"18",onClick:e[0]||(e[0]=a=>{A.back()})}),d("div",j,[d("span",null,m(f(E)("mine.customer_service")||"客服接口"),1)])]),d("section",C,[F.value?(y(),v("div",L,[p(n,{size:"28",color:"#1ed760"}),d("div",q,m(f(E)("common.loading")||"加载中..."),1)])):O.value?(y(),v("div",I,[p(o,{name:"warning-o",size:"48",color:"#ff4444"}),d("div",R,m(O.value),1),p(i,{class:"retry-btn",type:"primary",onClick:$},{default:_(()=>[...e[1]||(e[1]=[w("重试",-1)])]),_:1})])):P.value?(y(),v("iframe",{key:2,src:P.value,class:"kf-iframe",frameborder:"0",loading:"eager",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups",referrerpolicy:"strict-origin-when-cross-origin",onError:Q,onLoad:U},null,40,S)):g("",!0)]),e[2]||(e[2]=d("div",{class:"ft-h"},null,-1)),p(l,{active:"home"})])])}}},[["__scopeId","data-v-a66780f9"]]);export{A as default};
