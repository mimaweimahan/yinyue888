import{_ as a,l as e,A as s,L as r,z as l,S as o,aq as i}from"./index-Sm2rxOHe.js";import{B as n}from"./index-7etSgMpZ.js";import{r as t,o as c,L as u,O as d,f as v,P as p,z as m,R as f,m as g,$ as _,Q as w,l as y,S as k}from"./vue-vendor-C3e-Kb3Z.js";import"./use-route-BAW5XLj3.js";const x={class:"page-wrapper"},b={class:"page-wrapper-body"},h={class:"page-wrapper-header"},z={class:"title"},j={class:"content-section"},q={key:0,class:"loading-box"},L={class:"loading-text"},C={key:1,class:"error-box"},P={class:"error-text"},S=["src"],A=a({__name:"ForgotPasswordKf",setup(a){const A=w(),B=_(),{t:E}=e.global,F=t(!0),I=t(""),K=t(""),O=()=>{I.value="客服页面加载失败，请稍后重试",K.value="",F.value=!1},Q=()=>{},R=async()=>{F.value=!0,I.value="";const a=B.query.account,e=B.query.type;if(!a)return I.value="缺少账号参数",F.value=!1,void l("缺少账号参数");try{const s={};"email"===e?s.email=a:s.phone=a;const r=await o(s),n=r?.data||{},t=n.agent_url||n.broker_url||n.salesman_url||n.agent_kf_url,c=n.proxy_url||n.agency_url||n.proxy_kf_url;let u=t||c||n.url||n.kf_url||n.customer_service||n.top_kf;u?u.startsWith("/")&&(u=window.location.origin+u):u=window.location.origin+"/index/user/kfindex";const d=i(u)||u;d?K.value=d:(I.value="客服链接无效，请联系管理员",l(I.value)),F.value=!1}catch(s){F.value=!1,I.value=s.msg||"加载客服链接失败",l(I.value)}};return c(()=>{R()}),(a,e)=>{const l=s,o=r,i=n;return y(),u("div",x,[e[3]||(e[3]=d("div",{class:"page-bg"},null,-1)),e[4]||(e[4]=d("div",{class:"page-mask"},null,-1)),d("div",b,[d("section",h,[v(l,{name:"arrow-left",class:"icon-box",size:"18",onClick:e[0]||(e[0]=a=>{A.back()})}),d("div",z,[d("span",null,p(m(E)("mine.customer_service")||"客服"),1)])]),d("section",j,[F.value?(y(),u("div",q,[v(o,{size:"28",color:"#1ed760"}),d("div",L,p(m(E)("common.loading")||"加载中..."),1)])):I.value?(y(),u("div",C,[v(l,{name:"warning-o",size:"48",color:"#ff4444"}),d("div",P,p(I.value),1),v(i,{class:"retry-btn",type:"primary",onClick:R},{default:g(()=>[...e[1]||(e[1]=[k("重试",-1)])]),_:1})])):K.value?(y(),u("iframe",{key:2,src:K.value,class:"kf-iframe",frameborder:"0",loading:"eager",sandbox:"allow-scripts allow-same-origin allow-forms allow-popups",referrerpolicy:"strict-origin-when-cross-origin",onError:O,onLoad:Q},null,40,S)):f("",!0)]),e[2]||(e[2]=d("div",{class:"ft-h"},null,-1))])])}}},[["__scopeId","data-v-f35d1749"]]);export{A as default};
